---
title: 'Admin & Infrastructure Setup'
description: 'Provision and configure the entire analytics stack for your organization'
---

As an admin, you'll deploy and manage the complete analytics infrastructure, from core data platforms to AI integrations.


### 1. Configure Snowflake MCP Server

We use the Snowflake-managed MCP server functionality as this requires zero infrastructure management. 

Follow the [Snowflake documentation](https://docs.snowflake.com/en/user-guide/snowflake-cortex/cortex-agents-mcp) to do this, 
but note the caveats / guidance below. 

**1.1 Create MCP Role and Database**

```sql
-- Create MCP role
CREATE ROLE MCP;

-- Create MCP database and schema
CREATE DATABASE MCP;
CREATE SCHEMA MCP.PUBLIC;

-- Grant permissions
GRANT USAGE ON DATABASE MCP TO ROLE MCP;
GRANT USAGE ON SCHEMA MCP.PUBLIC TO ROLE MCP;
GRANT ALL ON ALL TABLES IN SCHEMA MCP.PUBLIC TO ROLE MCP;

-- Grant read access to data
GRANT USAGE ON DATABASE FIBER_MAP TO ROLE MCP;
GRANT USAGE ON ALL SCHEMAS IN DATABASE FIBER_MAP TO ROLE MCP;
GRANT SELECT ON ALL TABLES IN DATABASE FIBER_MAP TO ROLE MCP;
GRANT SELECT ON FUTURE TABLES IN DATABASE FIBER_MAP TO ROLE MCP;
```

**1.2 Create Security Integration (for Claude)**
Snowflake does not support Dynamic Client Registration. So we need to create a security integration for each client that will connect to the MCP.

```sql
CREATE SECURITY INTEGRATION MCPCLAUDE
  TYPE = OAUTH
  ENABLED = TRUE
  OAUTH_CLIENT = CUSTOM
  OAUTH_CLIENT_TYPE = 'PUBLIC' 
  OAUTH_REDIRECT_URI = 'https://claude.ai/api/mcp/auth_callback'
  OAUTH_ISSUE_REFRESH_TOKENS = TRUE
  OAUTH_REFRESH_TOKEN_VALIDITY = 7776000
  PRE_AUTHORIZED_ROLES_LIST = ('MCP')
  BLOCKED_ROLES_LIST = ('ACCOUNTADMIN', 'SECURITYADMIN');
```

<Note>
**Important**: Use `OAUTH_CLIENT = CUSTOM` (not `GENERIC` as stated in docs). And set the OAUTH_CLIENT_TYPE to Public not Private as in docs.
</Note>

**1.3 Provision MCP Server**

```sql
CREATE MCP SERVER MCP.PUBLIC.SEARCHLIGHT
FROM SPECIFICATION $$
  tools:
    - title: "SQL Execution Tool"
      name: "sql_exec_tool"
      type: "SYSTEM_EXECUTE_SQL"
      description: "A tool to execute SQL queries against the connected Snowflake database."
$$
;

GRANT USAGE ON MCP SERVER MCP.PUBLIC.SEARCHLIGHT TO ROLE MCP;
GRANT MODIFY ON MCP SERVER MCP.PUBLIC.SEARCHLIGHT TO ROLE MCP;
```

**1.4 Retrieve Connection Details**

```sql
-- Get Client ID and Client Secret
SELECT SYSTEM$SHOW_OAUTH_CLIENT_SECRETS('MCPCLAUDE');

-- Get Account Identifier
SELECT CURRENT_ACCOUNT();
```

<Warning>
Store Client ID and Client Secret securely. Use the `zh06779` format for account identifier (not the account locator format).
</Warning>

**1.5 Distribute to Users**

Provide users with:
- **Remote URL**: `https://zh06779.north-europe.azure.snowflakecomputing.com/api/v2/databases/MCP/schemas/PUBLIC/mcp-servers/SEARCHLIGHT`
- **Client ID**: From step 4
- **Client Secret**: From step 4
- **Account Identifier**: `zh06779.north-europe.azure`

**Grant MCP role to users:**
```sql
GRANT ROLE MCP TO USER username;
```

Then hook up Claude by following the steps from the [Business User setup](/analytics-stack/getting-started/business-user).

### 2. Deploy Prime MCP Server

The Prime MCP server is designed to run in a cloud server. Specifically it is set up to run in [Render](https://render.com/), though it could be deployed to any cloud server. 

Follow the instructions in the [Prime Github Repo](https://github.com/searchlight-capital/prime) to deploy your own instance (and speak to Miles). 


### 3. Deploy Mintlify Documentation

**3.1 Set Up Mintlify**

1. Sign up at [Mintlify](https://mintlify.com)
2. Connect to your `mintlify-docs` GitHub repository
3. Configure automatic deployments from `main` branch

**3.2 Customize Configuration**

Edit `docs.json` to match your organization:
- Update site name and colors
- Configure navigation structure
- Add your logo files

**3.3 Share Documentation URL**

Your docs will be available at: `https://your-org.mintlify.app`

### 4. Configure Braintrust

**4.1 Create Braintrust Workspace**

1. Sign up at [Braintrust](https://www.braintrustdata.com/)
2. Create organization workspace
3. Invite team members

**4.2 Clone the analytics-evals repo**
This provides a starting point for an evals implementation that works with Claude
[Analytics-Evals](https://github.com/searchlight-capital/analytics-evals)

**4.3 Create Evaluation Datasets**

Build test datasets with known good answers, in the Braintrust UI

See [docs](https://www.braintrust.dev/docs/core/datasets)
